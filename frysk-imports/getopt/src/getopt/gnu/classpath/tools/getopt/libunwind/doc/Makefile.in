### Makefile template for libunwind/doc/

all::

### Variables substituted from configure.

srcdir = @srcdir@
top_srcdir = @top_srcdir@
builddir = @builddir@
top_builddir = @top_builddir@
VPATH = @srcdir@

INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@

mandir = @mandir@
mkdir_p = @mkdir_p@
prefix = @prefix@
exec_prefix = @exec_prefix@

### man pages that go into section 3:

MANS = libunwind.man libunwind-dynamic.man libunwind-ia64.man	\
	libunwind-ptrace.man libunwind-setjmp.man			\
	unw_flush_cache.man						\
	unw_get_accessors.man						\
	unw_get_proc_info.man						\
	unw_get_proc_info_by_ip.man					\
	unw_get_proc_name.man						\
	unw_get_fpreg.man						\
	unw_get_reg.man							\
	unw_getcontext.man						\
	unw_init_local.man unw_init_remote.man				\
	unw_is_fpreg.man						\
	unw_is_signal_frame.man						\
	unw_create_addr_space.man					\
	unw_destroy_addr_space.man					\
	unw_regname.man unw_resume.man					\
	unw_set_caching_policy.man					\
	unw_set_fpreg.man						\
	unw_set_reg.man							\
	unw_step.man							\
	unw_strerror.man						\
	_U_dyn_register.man						\
	_U_dyn_cancel.man

L2M	= latex2man
L2P	= pdflatex
L2M_CMD	= $(L2M) -t $(srcdir)/libunwind.trans
L2H_CMD	= $(L2M) -H -t $(srcdir)/libunwind.trans

%.man: %.tex
	$(L2M_CMD) $< $@
	-cp $@ $(srcdir)/$@

###

all:: $(MANS)

distclean clean check::

installdirs::
	$(mkdir_p) "$(DESTDIR)$(mandir)/man3"

install-%.man:
	$(INSTALL_DATA) $(srcdir)/$*.man "$(DESTDIR)$(mandir)/man3/$*.3"

install:: all installdirs $(addprefix install-,$(MANS))

uninstall-%.man:
	-rm -f "$(DESTDIR)$(mandir)/man3/$*.3"

uninstall:: $(addprefix uninstall-,$(MANS))

html:
	for n in $(man3_MANS); do					\
		page=`basename $$n .man`;				\
		$(L2H_CMD) $(srcdir)/$$page.tex "$$page(3).php";	\
	done

pdf:
	for n in $(man3_MANS); do					\
		page=`basename $$n .man`;				\
		$(L2P) $(srcdir)/$$page.tex "$$page(3).pdf";		\
	done

.PHONEY: all check clean distclean installdirs install uninstall html pdf
.NOEXPORT:
