2007-03-07  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/test-async-sig.c (do_backtrace): Limit maximum backtrace depth
	to 100 iterations; it workarounds FC6 DWARF-broken glibc.

2007-03-02  Nurdin Premji  <npremji@redhat.com>

	* src/elfxx.c (lookup_symbol): Undo previous correction, buf_len is decremented previously.

2007-02-28  Nurdin Premji  <npremji@redhat.com>

	* src/elfxx.c (lookup_symbol): Fix stack smashing buf memcpy.

2007-02-28  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/Makefile.in (clean): No longer remove some source scripts.

2007-02-28  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/check-namespace.sh.in: Backward compatible $(top_builddir) fix
	for the autoconf-2.59c compatibility.

2007-01-24  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* src/elfxx.c (lookup_symbol): Fix false preceding zero-sized function
	resolving (printed `_start' symbols for stripped binaries).

2006-12-18  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* src/elfxx.c (lookup_symbol): Fix regression in the 2006-12-10 bugfix;
	on already prelink(8)ed libraries loaded at a different address.
	No testcase provided as prelink(8) need `root' privileges.

2006-12-17  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/check-namespace.sh.in (check_local_unw_abi): Restrict the
	checking of `unw_tdep_getcontext' only for platforms it is built on.

2006-12-16  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/Gtest-resume-sig.c (main): Return SKIP instead of FAIL on ia64
	as the libunwind functionality is still not implemented for non-ia64.

2006-12-11  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/Makefile.in (XFAIL_TESTS): `run-ptrace-signull' is now XFAIL
	until the clone() CFI unwind stopping gets resolved in glibc.

2006-12-10  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* src/x86/Gstep.c (code_descriptor_trap): Handle the cases of signal
	frame leaving stale address due to page fault on an instruction fetch.
	(unw_step): Call `code_descriptor_trap' above.
	Debug dump the content of signal frame set from CFI.
	Fixed non-CFI signal frame detection regarding its false positives.
	Debug dump whether non-CFI unwinding as signal frame or not.
	* src/x86/offsets.h: New signal frame value `LINUX_SC_TRAPNO_PF'.

2006-12-10  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* src/x86/Gfetch_proc_info_post.c: Set `cursor->sigcontext_addr'
	even for CFI-unwinded signal frames.
	* src/x86/Make-arch.in: Include `Gfetch_proc_info_post.o'.
	* include/tdep-x86/libunwind_i.h (tdep_fetch_proc_info_post): Now
	declaration.

2006-12-10  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* src/x86_64/Gstep.c (unw_step): Fixed debug message exhanged values.

2006-12-10  Jan Kratochvil  <jan.kratochvil@redhat.com>

        * src/x86/Gstep.c (unw_step): Handle the case of `c->dwarf.ip == 0'.
	* src/x86_64/Gstep.c (code_descriptor_trap): Handle the cases of signal
	frame leaving stale address due to page fault on an instruction fetch.
	(unw_step): Call `code_descriptor_trap' above.
	Debug dump the content of signal frame set from CFI.
	Handle the case of `c->dwarf.ip == 0'.
        * src/x86_64/ucontext_i.h: New signal frames fields `err' and `trapno'.
        * tests/Makefile.in: New `run-ptrace-signull'.
	* tests/run-ptrace-signull: New (NULL handling: gdb `signull' testcase).
	* tests/test-ptrace-signull.c: Likewise.

2006-12-10  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* src/x86_64/Gfetch_proc_info_post.c: Set `cursor->sigcontext_addr'
	even for CFI-unwinded signal frames.
	* src/dwarf/Gparser.c (fetch_proc_info): Call it.
	* src/x86_64/Make-arch.in: Include `Gfetch_proc_info_post.o'.
	* include/tdep-x86_64/libunwind_i.h (tdep_fetch_proc_info_post): New
	(declaration).
	* include/tdep-hppa/libunwind_i.h (tdep_fetch_proc_info_post): New
	(empty definition).
	* include/tdep-ia64/libunwind_i.h (tdep_fetch_proc_info_post):
	Likewise.
	* include/tdep-ppc64/libunwind_i.h (tdep_fetch_proc_info_post):
	Likewise.
	* include/tdep-x86/libunwind_i.h (tdep_fetch_proc_info_post):
	Likewise.

2006-12-10  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* src/elfxx.c (lookup_symbol): Avoid returning irrelevant symbols
	defined as the last ones before the address in different section.

2006-12-10  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* src/elfxx.c (lookup_symbol): Fixed excessive buffer size requirement.

2006-12-10  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/test-ptrace.c (main): Check for too many unexpected child
	signals, such as the common `SIGSEGV'.

2006-12-10  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/Gtest-resume-sig.c (handler): Fixed false PASS on non-ia64.
	Be adaptive to the number of unwinding steps from `SIGUSR1'.

2006-12-10  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* src/dwarf/Gparser.c (apply_reg_state): Handle undefined PC by
	`c->ip = 0' as in the case of the outermost frame of clone(3).

2006-12-01  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/test-ptrace.c: Fixed `-b' to report missed target function.

2006-11-25  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/test-ptrace.c: Fixed `-b' to never leave a stale child process.

2006-11-24  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* tests/run-ptrace-stepper: Fixed signal frame name for x86_64.

2006-11-24  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* src/Makefile.in (INCFLAGS): Backward compatible $(top_builddir) fix
	for the autoconf-2.59c compatibility.
	* tests/Makefile.in (INCFLAGS, LDFLAGS): Likewise.

2006-11-24  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* include/dwarf.h (dwarf_cie_info): New `signal_frame' marker.
	(dwarf_cursor): New `decrease_ip' marker.
	* src/dwarf/Gfde.c (parse_cie): Set the `signal_frame' marker.
	* src/dwarf/Gparser.c (run_cfi_program): Fixed occassionally offbyone
	`ip' missed CFI instructions, related to `fetch_proc_info'.
	(fetch_proc_info): Decrease parent `ip' only by `decrease_ip' marker.
	(is_signal_frame): Detect signal frames by the `signal_frame' marker.
	(uncached_dwarf_find_save_locs): Update the `decrease_ip' marker.
	(dwarf_find_save_locs): Likewise.
	* src/hppa/init.h (common_init): Initialize the `decrease_ip' marker.
	* src/ppc64/init.h (common_init): Likewise.
	* src/x86/init.h (common_init): Likewise.
	* src/x86_64/init.h (common_init): Likewise.
	* tests/Makefile.in: New `run-ptrace-stepper' and `test-ptrace-stepper'.
	* tests/test-ptrace.c (backtrace_check): New for `-b'.
	(do_exit): Variable to support breaking of the `main' mainloop.
	(do_backtrace): Implemented `-b' based on `backtrace_check'.
	Fixed compile warning for 32-bit platforms
	(main): Fixed segfault for some `argv's.
	Support backtrace option `-b' - `,'-delimited backtrace list to check.
	Support `do_exit'.
	* test-ptrace-stepper.c: New, test corner backtrace conditions.
	* run-ptrace-stepper: New, test `test-ptrace' on `test-ptrace-stepper'.

2006-09-27  Alexandre Oliva  <aoliva@redhat.com>

	* src/elfxx.c (lookup_symbol): Cope with NULL buf and zero buf_len.
	* src/mi/Gget_proc_name.c (intern_string, get_proc_name): Likewise.
	* src/hppa/Gget_proc_info.c (unw_get_proc_info): Use it.
	* src/x86/Gget_proc_info.c (unw_get_proc_info): Likewise.
	* src/x86_64/Gget_proc_info.c (unw_get_proc_info): Likewise.
	* doc/unw_get_proc_name.tex: Document NULL buf and zero buf_len.
	* doc/unw_create_addr_space.tex (get_proc_name): Likewise.
	* doc/unw_get_proc_name.man: Rebuilt.
	* doc/unw_create_addr_space.man: Likewise.

2006-09-20	Arun Sharma	<arun.sharma@google.com>

	* src/dwarf/Gparser.c (hash): Fixes the compiler warning on x86-32.

2006-09-20  Alexandre Oliva  <aoliva@redhat.com>

	* src/os-linux.h (maps_next): Don't error out just because
	path is missing.
	* include/tdep-hppa/libunwind_i.h (tdep_get_elf_image): Add as
	and arg to the parameter list.
	* include/tdep-ia64/libunwind_i.h (tdep_get_elf_image): Ditto.
	* include/tdep-ppc64/libunwind_i.h (tdep_get_elf_image): Ditto.
	* include/tdep-x86/libunwind_i.h (tdep_get_elf_image): Ditto.
	* include/tdep-x86_64/libunwind_i.h (tdep_get_elf_image): Ditto.
	* src/elfxx.h (get_proc_name): Ditto.
	* src/elfxx.c (get_proc_name): Ditto.  Adjust.
	* src/hppa/Ginit.c (get_static_proc_name): Adjust.
	* src/ia64/Ginit.c (get_static_proc_name): Ditto.
	* src/ppc64/Ginit.c (get_static_proc_name): Ditto.
	* src/x86/Ginit.c (get_static_proc_name): Ditto.
	* src/x86_64/Ginit.c (get_static_proc_name): Ditto.
	* src/ptrace/_UPT_find_proc_info.c (get_unwind_info): Ditto.
	* src/ptrace/_UPT_get_proc_name.c (_UPT_get_proc_name): Ditto.
	* src/os-hpux.c (tdep_get_elf_image): Ditto.
	* src/os-linux.c (tdep_get_elf_image): Ditto.  Read in 1-page
	segments that start with the ELF magic.
	(MAX_VDSO_SIZE): New.

2006-09-16  Alexandre Oliva  <aoliva@redhat.com>

	* src/x86/Gget_proc_info.c (unw_get_proc_info): Use
	unw_get_proc_name to build a proper proc_info_t.
	* src/x86_64/Gget_proc_info.c (unw_get_proc_info): Likewise.
	* src/hppa/Gget_proc_info.c (unw_get_proc_info): Likewise.

2006-09-16  Alexandre Oliva  <aoliva@redhat.com>

	* configure.ac: Don't define UNW_REMOTE_ONLY.
	* src/os-linux.c: Restore #ifndef removed it previous patch.

2006-09-12  Yao Qi  <qiyaoltc@cn.ibm.com>

	* src/ptrace/_UPT_find_proc_info.c: Add UNW_TARGET_PPC64 in #elif.

2006-09-08	Alexandre Oliva  <aoliva@redhat.com>

	* src/os-linux.c (tdep_get_elf_image): Define for remote only too.

2006-08-29  Wu Zhou  <woodzltc@cn.ibm.com>

	* include/libunwind-ppc64.h: New header file for ppc64 stubs.
	* include/tdep-ppc64/dwarf-config.h: Ditto.
	* include/tdep-ppc64/jmpbuf.h: Ditto.
	* include/tdep-ppc64/libunwind_i.h: Ditto.
	* include/tdep-ppc64/README: Readme file for this directory.
	* src/ppc64/Gcreate_addr_space.c: New file for ppc64 stubs.
	* src/ppc64/Gget_proc_info.c: Ditto.
	* src/ppc64/Gget_save_loc.c: Ditto.
	* src/ppc64/Gglobal.c: Ditto.
	* src/ppc64/Ginit.c: Ditto.
	* src/ppc64/Ginit_local.c: Ditto.
	* src/ppc64/Ginit_remote.c: Ditto.
	* src/ppc64/Gis_signal_frame.c: Ditto.
	* src/ppc64/Gregs.c: Ditto.
	* src/ppc64/Gresume.c: Ditto.
	* src/ppc64/Gstep.c: Ditto.
	* src/ppc64/init.h: Ditto.
	* src/ppc64/is_fpreg.c: Ditto.
	* src/ppc64/longjmp.S: Ditto.
	* src/ppc64/Make-arch.in: Ditto.
	* src/ppc64/README: Readme file for directory src/ppc64.
	* src/ppc64/regname.c: New file for ppc64 stubs.
	* src/ppc64/setcontext.S: Ditto.
	* src/ppc64/siglongjmp.S: Ditto.
	* src/ppc64/ucontext_i.h: Ditto.
	* src/ppc64/unwind_i.h: Ditto.
	* src/ptrace/_UPT_reg_offset.c (_UPT_reg_offset): Define empty
	register offset for target PPC64.

2006-08-17  Stepan Kasal  <kasal@ucw.cz>

	* Makefile.in (installcheck): Another stub target.

2006-08-16  Andrew Cagney  <cagney@redhat.com>

	* Makefile.in (dvi): Add phony target.

2006-08-10  Rick Moseley  <rmoseley@redhat.com>

	* configure.ac: Turn on UNW_REMOTE_ONLY always for Frysk.

2006-07-14  Stepan Kasal  <kasal@ucw.cz>

	* Makefile.in: Do not install for frysk.

2006-07-12  Stepan Kasal  <kasal@ucw.cz>

	* Makefile.in: Add a dangerous temporary implementtation of the
	``distdir'' target.

***********************************************************

	Discontinued.  See bitkeeper log instead at

		http://unwind.bkbits.net/

***********************************************************

2002-11-08  David Mosberger-Tang  <David.Mosberger@acm.org>

	* src/ia64/unwind_i.h (ia64_getfp): Change from macro to inline
	function.  Check "loc" argument for being NULL before dereferencing it.
	(ia64_putfp): Ditto.
	(ia64_get): Ditto.
	(ia64_put): Ditto.

2002-01-18  David Mosberger-Tang  <David.Mosberger@acm.org>

	* src/ia64/parser.c (__ia64_unw_create_state_record): Set
	IA64_FLAG_HAS_HANDLER if the unwind info descriptors indicate that
	there a handler.

	* src/ia64/regs.c (__ia64_access_reg): Return zero for UNW_REG_HANDLER
	in frames that don't have a personality routine.

	* src/ia64/unwind_i.h (IA64_FLAG_HAS_HANDLER): New flag.

	* src/ia64/regs.c (__ia64_access_reg): When reading UNW_REG_HANDLER,
	account for the fact that the personality address is gp-relative.

	* src/ia64/parser.c (__ia64_unw_create_state_record): Fix
	initialization of segbase and len.

2002-01-17  David Mosberger-Tang  <David.Mosberger@acm.org>

	* include/unwind-ia64.h: Include via "unwind.h" to ensure
	the file is picked up from same directory.

2002-01-16  David Mosberger-Tang  <David.Mosberger@acm.org>

	* include/unwind.h: Define UNW_ESTOPUNWIND.  This error code may
	be returned by acquire_unwind_info() to force termination of
	unwinding.  An application may want to do this when encountering a
	call frame for dynamically generated code, for example.

	* unwind.h: Pass opaque argument pointer to acquire_unwind_info()
	and release_unwind_info() like we do for access_mem() etc.

2002-01-14  David Mosberger-Tang  <David.Mosberger@acm.org>

	* Version 0.0 released.

2002-01-11  David Mosberger-Tang  <David.Mosberger@acm.org>

	* ChangeLog created.
