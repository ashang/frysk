2006-07-24  Adam Jocksch  <ajocksch@redhat.com>

	* Elf.java (Elf): Made public, for use in libdw{fl}, but still should
	not be called.
	* ElfSectionHeader.java (name): Now is the actual string rather than
	the index.
	* cni/ElfSection.cxx (elf_getshdr): Now retrieves the string table 
	indices and sets the actual section names.
	* tests/TestElf.java: GNU formatted.
	(testObjectFile): Now tests against the actual section names.

2006-07-20  Tim Moore  <timmore@redhat.com>

	* ElfFileException.java: New class.
	* Elf.java (Elf(String, ElfCommand)): Throw exceptions.
	(Elf(int, ElfCommand)): Open the executable Elf file associated with a
	pid.
	(Elf(String, long)): comment out.
	* cni/Elf.cxx (elf_begin): Use the length of the UTF translation of the
	file name for sizing the fileName array. Throw an ElfFileException
	instead of an ElfException.
	(elf_memory): Comment out.
	* tests/TestElf.java (TestElf): throw exceptions.

2006-06-27  Adam Jocksch  <ajockshc@redhat.com>

	* cni/Elf.cxx (elf_begin): Now prints out a more informative
	message when the file open fails.

2006-06-23  Adam jocksch  <ajocksch@redhat.com>

	* tests/TestElf.cxx (testCore): Now uses Build.ABS_BUILDDIR.
	(testObjectFile): Ditto. 

2006-06-21  Adam Jocksch  <ajocksch@redhat.com>

	* cni/Elf.cxx (elf_getehdr): No longer uses JvMalloc, now passes in
	the address of the local variable.
	(elf_getphdr): Ditto.
	* cni/ElfSection.cxx (elf_getshdr): Ditto.

2006-06-20  Adam Jocksch  <ajocksch@redhat.com>

	* ElfEHeader32.java: Removed.
	* ElfEHeader64.java: Removed.
	* ElfPHeader32.java: Removed.
	* ElfPHeader64.java: Removed.
	* ElfSectionHeader32.java: Removed.
	* ElfSectionHeader64.java: Removed.

	* Elf.java (Elf): No longer takes 32bit boolean.
	(elf_getehdr): Now returns a ElfEHeader.
	(getEHeader): refactored to reflect above change.
	(elf_newehdr): Now returns an int.
	(createNewEHeader): Refactored to reflect above change.
	(getPHeaders): Removed.
	(getPHeader): Added.
	(elf_newphdr): Now returns an int.
	(createNewPHeader): Refactored to reflect above change.
	(elf_getarhdr): Now returns an ElfArchiveHeader.
	(getArchiveHeader): Refactored to reflect above changes.
	* ElfArchiveHeader.java (getName): replaced with public variable.
	(getDate): Ditto.
	(getUid): Ditto.
	(getGid): Ditto.
	(getMode): Ditto.
	(getSize): Ditto.
	(getRawName): Ditto.
	(getPointer): Removed.
	(elf_ar_get_name): Ditto.
	(elf_ar_get_date): Ditto.
	(elf_ar_get_uid): Ditto.
	(elf_ar_get_gid): Ditto.
	(elf_ar_get_mode): Ditto.
	(elf_ar_get_size): Ditto.
	(elf_ar_get_raw_name): Ditto.
	* ElfData.java (ElfData): No longer takes a 32 bit boolean flag.
	* ElfEHeader.java (getPointer): Removed.
	(getFileClass): Removed, replaced with public variable.
	(getDataEncoding): Ditto.
	(getFileVersion): Ditto.
	(getType): Ditto.
	(getArchitechture): Ditto.
	(getVersion): Ditto.
	(getEntryPoint): Ditto.
	(getProgramHeaderOffset): Ditto.
	(getSectionHeaderOffset): Ditto.
	(getFlags): Ditto.
	(getELFHeaderSize): Ditto.
	(getProgramHeaderEntrySize): Ditto.
	(getProgramHeaderEntryCount): Ditto.
	(getSectionHeaderEntryCount): Ditto.
	(getSectionHeaderStringTableIndex): Ditto.
	(get_e_fileclass): Removed.
	(get_e_dataencoding): Ditto.
	(get_e_fileversion()): Ditto.
	(get_e_type()): Ditto.
	(get_e_machine()): Ditto.
	(get_e_version()): Ditto.
	(get_e_entry()): Ditto.
	(get_e_phoff()): Ditto.
	(get_e_shoff()): Ditto.
	(get_e_flags()): Ditto.
	(get_e_ehsize()): Ditto.
	get_e_phentsize()): Ditto.
	(get_e_phnum()): Ditto.
	(get_e_shentsize()): Ditto.
	(get_e_shnum()): Ditto.
	(get_e_shstrndx()): Ditto.
	* ElfPHeader.java (ElfPHeader): Now only takes a pointer to the Elf 
	parent object.
	(getType): Replaced by public variable.
	(getOffset): Ditto.
	(getVirtualAddress): Ditto.
	(getPhysicalAddress): Ditto.
	(getSegmentSizeInFile): Ditto.
	(getSegmentSizeInMem): Ditto.
	(getFlags): Ditto.
	(getAlignment): Ditto.
	(getPointer): Ditto.
	(get_p_type): Removed.
	(get_p_offset): Ditto.
	(get_p_vaddr): Ditto.
	(get_p_paddr): Ditto.
	(get_p_filesz): Ditto.
	(get_p_memsz): Ditto.
	(get_p_align): Ditto.
	(get_p_flags): Ditto.
	* ElfSection.java (ElfSection): No longer takes a 32 bit boolean flag.
	(elf_getshdr): Now returns a ElfSectionHeader.
	(getSectionHeader): Refactored to reflect above change.
	(getData): Refactored to reflect change to ElfData constructor.
	(getRawData): Ditto.
	(createNewElfData): Ditto.
	* ElfSectionHeader.java (ElfSectionHeader): Now only takes a pointer to
	the parent Elf object.
	(getPointer): Removed.
	(getNameIndex): Replaced by local variable.
	(getType): Ditto.
	(getFlags): Ditto.
	(getAddress): Ditto.
	(getOffset): Ditto.
	(getSize): Ditto.
	(getLink): Ditto.
	(getAdditionalInfo): Ditto.
	(getAlignment): Ditto.
	(getEntrySize): Ditto.
	(get_sh_name): Removed.
	(get_sh_type): Ditto.
	(get_sh_flags): Ditto.
	(get_sh_addr): Ditto.
	(get_sh_offset): Ditto.
	(get_sh_size): Ditto.
	(get_sh_link): Ditto.
	(get_sh_info): Ditto.
	(get_sh_addralign): Ditto.
	(get_sh_entsize): Ditto.
	* cni/Elf.cxx (elf_begin): No longer does 32/64 bit check.
	(elf_memory): No longer uses alloca.
	(fillEHeader): Added.
	(elf_getehdr): Now returns a ElfEHeader and uses gelf.
	(elf_newehdr): Now returns an int and uses gelf.
	(elf_getphdrs): Removed.
	(elf_getphdr): Added.
	(elf_newphdr): Now returns an int and uses gelf.
	(elf_offscn): Now uses gelf.
	(elf_getarhdr): Now returns an ElfArchiveHeader.
	* cni/ElfArchiveHeader.cxx: Removed.
	* cni/ElfSectionHeader32.cxx: Ditto.
	* cni/ElfSectionHeader64.cxx: Ditto.
	* cni/ElfEHeader32.cxx: Ditto.
	* cni/ElfEHeader64.cxx: Ditto.
	* cni/ElfPHeader32.cxx: Ditto.
	* cni/ElfPHeader64.cxx: Ditto.
	* cni/ElfSection.cxx (elf_getshdr): Now returns an ElfSectionHeader
	object.
	* tests/TestElf.java: Now uses the public variables instead of methods.

2006-06-16  Adam Jocksch  <ajocksch@redhat.com>

	* cni/ElfData.cxx (elf_xlatetom): Now initializes the Elf_Data
	pointer.
	(elf_xlatetof): Ditto.

	* Elf.java (getIdentification): No longer takes a parameter.
	(elf_getident): Ditto.
	(elf_getshnum): Ditto.
	(elf_getshstrndx): Ditto.
	(getSectionNumber): Ditto, renamed to getSectionCount.
	(getSectionIndex): No longer takes a parameter and renamed to
	getSHeaderStringTableIndex.
	* ElfData.java (translateToMemoryRepresentation): Implemented.
	(translateToELFRepresentation): Ditto.
	* cni/Elf.cxx: (elf_getident): No longer takes paramenter.
	(elf_getshnum): Ditto.
	(elf_getshstrndx): Ditto.
	* cni/ElfData.cxx (elf_xlatetom): Implemented.
	(elf_xlatetof): Ditto.

2006-06-15  Adam Jocksch  <ajocksch@redhat.com>

	* Elf.cxx (elf_getident): Fixed 64bit bug.
	(elf_getshnum): Ditto.
	(elf_getshstrndx): Ditto.
	(elf_getarsym): Ditto.
	(elf_rawfile): Ditto.

2006-06-05  Adam Jocksch  <ajocksch@redhat.com>

	* Elf.cxx: Now uses alloca instead of malloc.

2006-06-02  Yao Qi  <qiyaoltc@cn.ibm.com>

        * frysk-imports/lib/elf/cni/Elf.cxx : Add C string terminator
	to fileName.

2006-05-31  Adam Jocksch  <ajocksch@redhat.com>

	* ElfArchiveHeader.java (elf_ar_new): Removed.
	(elf_ar_finalize): Removed.

	* ElfArchiveHeader.java (ElfArchiveHeader): Now takes a reference to the
	parent Elf object to keep it from being garbage collected, also removed
	default constructor.
	(getParent): Added.
	(finalize): Removed.
	* ElfArchiveSymbol.java (ElfArchiveSymbol): Now takes a reference to the
	parent Elf object, also removed default constructor.
	(getParent): Added.
	(finalize): Removed.
	* ElfData.java (ElfData): Now takes a reference to the parent Elf object.
	(getParent): Added.
	* ElfEHeader.java (ElfEHeader): Now takes a reference to the parent Elf
	object.
	(getPointer): Added.
	* ElfEHeader32.java (ElfEHeader32): Now takes a reference to the parent
	Elf object.
	* ElfEHeader64.java (ElfEHeader64): Ditto.
	* ElfPHeader.java (ElfPHeader): Ditto.
	(getParent): Added.
	* ElfPHeader32.java (ElfPHeader32): Now takes a reference to the parent
	Elf object.
	* ElfPHeader64.java (ElfPHeader64): Ditto.
	* ElfSection.java (ElfSection): Ditto.
	(getParent): Added.
	* ElfSectionHeader.java (ElfSectionHeader): Now takes a reference to
	the parent Elf object.
	(getParent): Added.
	* ElfSectionHeader32.java (ElfSectionHeader32): Now takes a reference
	to the parent Elf object.
	* ElfSectionHeader64.java (ElfSectionHeader64): Ditto.
	* cni/ElfArchiveHeader.cxx (elf_ar_new): Removed.
	(elf_ar_finalize): Ditto.
	* cni/ElfArchiveSymbol.cxx (elf_as_new): Ditto.
	(elf_as_finalize): Ditto.

2006-05-24  Adam Jocksch  <ajocksch@redhat.com>
	
	* tests/TestElf.java: Added Frysk header.
	* Elf.java (getPointer): Made public, will need to be accessed from
	libdw wrapper.
	* ElfSection.java (getPointer): Ditto.

2006-05-23  Adam Jocksch  <ajocksch@redhat.com>

	* tests/TestElf.java (testCore): Added tests for ElfPHeader.
	(testOFile): Renamed to testObjectFile.

2006-05-22  Andrew Cagney  <cagney@redhat.com>

	* cni/ElfData.cxx (elf_data_get_byte): Check offset non negative.
	Cast to size_t when comparing to size.

2006-05-19  Adam Jocksch  <ajocksch@redhat.com>

	* cni/Elf.cxx (elf_getphdrs): Now uses elements to assign the items.

	* Elf.java (getPHeader): Renamed to getPHeaders, now returns an array of
	ElfPHeaders.
	(elf_getphdr): Renamed to elf_getphdrs.
	* ElfSection.java (getData): Now returns null if C function returns 0.
	* cni/Elf.cxx (elf_getphdr): Renamed to elf_getphdrs, returns an array
	of longs.
	* tests/TestElf.java (testOFile): Added, tests a provided .o file.
	* tests/helloworld.o.bz2.uu: Added.

2006-05-18  Adam Jocksch  <ajocksch@redhat.com>

	* Elf.java (getSection): Now returns null if index was invalid.
	(getNextSection): Now returns null if there is no next section.
	* ElfException.java (ElfException): Added, takes a string.
	* ElfKind.java (toString): Added.
	* ElfSection.java (getSectionHeader): Now returns null if no header
	found.
	* cni/Elf.cxx: (elf_begin): Now calls elf_version before calling
	elf_begin, also throws ElfExceptions in case of errors.
	* tests/TestElf.java: Added.

	* Elf.java (Elf): Now takes a boolean indicating whether the
	file is 32 or 64 bit.
	(clone): The new Elf object now has the same 32/64 bitness as
	the original.

	* Elf.java (clone): Added.
	(elf_clone): Now returns long and now only takes an int.
	* cni/Elf.cxx (clone): Now takes only an int and returns a long.

2006-05-17  Adam Jocksch  <ajocksch@redhat.com>

	* tests/test-core.tgz: Removed.
	* tests/test-core.bz2.uu: Added, replaces test-core.tgz.

	* tests: Added.
	* tests/test-core.tgz: Added, test core dump (uuencoded and zipped)
	to be used as a basis for libelf wrapper tests.

2006-05-16  Adam Jocksch  <ajocksch@redhat.com>

	* ElfEHeader.java (get_e_ident): Removed.
	(get_e_fileclass): Added.
	(get_e_dataencoding): Added.
	(get_e_fileversion): Added.
	(getIdentifier): Removed.
	(getFileClass): Added.
	(getDataEncoding): Added.
	(getFileVersion): Added.
	* ElfHeader32.java: Updated native methods to reflect change in
	superclass.
	* ElfHeader64.java: Ditto.
	* cni/ElfEHeader32.cxx: (get_e_ident): Removed.
	(get_e_fileclass): Added.
	(get_e_dataencoding): Added.
	(get_e_fileversion): Added.
	* cni/ElfEHeader64.cxx: Ditto.

	* ChangeLog: Fixed formatting of previous entries.
	* Elf.java (flag): Now takes an ElfFlags and returns the same.
	(flagEHeader): Ditto.
	(flagPHeader): Ditto.
	* ElfData.java (flag): Ditto.
	* ElfSection.java (flag): Ditto.
	(flagHeader): Ditto.
	* ElfFlags.java: Added.
	* ElfKind.java: Made constants final.
	* ElfType.java: Ditto.
	* ElfCommand.java: Ditto.

2006-05-15  Adam Jocksch  <ajocksch@redhat.com>

	* Elf.java: Added javadoc comments to classes and all public methods.
	* ElfArchiveHeader.java: Ditto.
	* ElfArchiveSymbol.java: Ditto.
	* ElfCommand.java: Ditto.
	* ElfData.java:  Ditto.
	* ElfEHeader.java:  Ditto.
	* ElfEHeader32.java:  Ditto.
	* ElfEHeader64.java:  Ditto.
	* ElfError.java:  Ditto.
	* ElfException.java: Ditto.
	* ElfKind.java:  Ditto.
	* ElfPHeader.java:  Ditto.
	* ElfPHeader32.java: Ditto.
	* ElfPHeader64.java:  Ditto.
	* ElfSection.java: Ditto.
	* ElfSectionHeader.java: Ditto.
	* ElfSectionHeader32.java: Ditto.
	* ElfSectionHeader64.java: Ditto.
	* ElfType.java: Ditto.

2006-05-11  Adam Jocksch  <ajocksch@redhat.com>

	* Elf.java: Added frysk header.
	* ElfArchiveHeader.java: Ditto.
	* ElfArchiveSymbol.java: Ditto.
	* ElfCommand.java: Ditto.
	* ElfData.java:  Ditto.
	* ElfEHeader.java:  Ditto.
	* ElfEHeader32.java:  Ditto.
	* ElfEHeader64.java:  Ditto.
	* ElfError.java:  Ditto.
	* ElfException.java: Ditto.
	* ElfKind.java:  Ditto.
	* ElfPHeader.java:  Ditto.
	* ElfPHeader32.java: Ditto.
	* ElfPHeader64.java:  Ditto.
	* ElfSection.java: Ditto.
	* ElfSectionHeader.java: Ditto.
	* ElfSectionHeader32.java: Ditto.
	* ElfSectionHeader64.java: Ditto.
	* ElfType.java: Ditto.
	* cni/Elf.cxx: Ditto.
	* cni/ElfArchiveHeader.cxx: Ditto.
	* cni/ElfArchiveSymbol.cxx: Ditto.
	* cni/ElfData.cxx: Ditto.
	* cni/ElfEHeader32.cxx: Ditto.
	* cni/ElfEHeader64.cxx: Ditto.
	* cni/ElfPHeader32.cxx: Ditto.
	* cni/ElfPHeader64.cxx: Ditto.
	* cni/ElfSection.cxx: Ditto.
	* cni/ElfSectionHeader32.cxx: Ditto.
	* cni/ElfSectionHeader64.cxx: Ditto.

2006-05-08  Adam Jocksch  <ajocksch@redhat.com>
	* ChangeLog: Created.
	* Elf.java: Added.
	* ElfEHeader.java: Ditto.
	* ElfEHeader32.java: Ditto.
	* ElfEHeader64.java: Ditto.
	* ElfPHeader.java: Ditto.
	* ElfPHeader32.java: Ditto.
	* ElfPHeader64.java: Ditto.
	* ElfArchiveHeader.java: Ditto.
	* ElfArchiveSymbol.java: Ditto.
	* ElfCommand.java: Ditto.
	* ElfData.java: Ditto.
	* ElfError.java: Ditto.
	* ElfException.java: Ditto.
	* ElfKind.java: Ditto.
	* ElfSectionHeader.java: Ditto.
	* ElfSectionHeader32.java: Ditto.
	* ElfSectionHeader64.java: Ditto.
	* ElfSection.java: Ditto.
	* ElfType.java: Ditto.
	* cni: Ditto.
	* cni/ElfArchiveHeader.cxx: Ditto.
	* cni/ElfArchiveSymbol.cxx: Ditto.
	* cni/ElfData.cxx: Ditto.
	* cni/ElfEHeader32.cxx: Ditto.
	* cni/ElfEHeader64.cxx: Ditto.
	* cni/ElfPHeader32.cxx: Ditto.
	* cni/ElfPHeader64.cxx: Ditto.
	* cni/ElfSectionHeader32.cxx: Ditto.
	* cni/ElfSectionHeader64.cxx: Ditto.
	* cni/ElfSection.cxx: Ditto.
	* cni/Elf.cxx: Ditto.
