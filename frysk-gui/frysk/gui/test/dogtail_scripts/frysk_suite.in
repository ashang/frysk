#! /bin/bash
#
# Temporary shell script
#
# As of June 8, 2006, there's a problem with 
# the test suite - either Frysk or Dogtail gets confused and attempts
# to run tests before other tests have completed - short-term workaround
# is to comment out these lines, run the tests separately, and read
# the datafiles from the CLI       

# Is accessability enabled?

accessibility=`gconftool-2 --get /desktop/gnome/interface/accessibility`
if test "$accessibility" = false ; then
    cat <<EOF 1>&2
Your machine does not have accessability enabled, enter:
    gconftool-2 --type bool --set /desktop/gnome/interface/accessibility true
to enable it.
EOF
    exit 77
fi

frysk=@abs_builddir@/frysk/gui/FryskGui
src=@abs_srcdir@/frysk/gui/test/dogtail_scripts

cat <<EOF | grep -v '#' | while read script args ; do
${src}/TestCredits.py 
${src}/TestLicense.py 
${src}/TestCreateObservers.py
${src}/TestCreateObserversfromDataModel.py ${src}/new_fork_custom_observer.xml
# Run this one last for now - 20060609 - it hangs all bash processes on 
# the system - http://sourceware.org/bugzilla/show_bug.cgi?id=2741 
${src}/TestDruid.py ${src}/another_new_session.xml
EOF
    echo Running: ${script}
    if python ${script} ${frysk} ${args} ; then
	:
    else
	echo "Failing ${script}"
	exit 1
    fi
done || exit 1
